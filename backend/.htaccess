<IfModule mod_rewrite.c>
  RewriteEngine On

  # 1. Remove www prefix
  RewriteCond %{HTTP_HOST} ^www\.askfoundations\.org [NC]
  RewriteRule ^ https://askfoundations.org%{REQUEST_URI} [R=301,L]

  # 2. Force HTTPS
  RewriteCond %{HTTPS} off
  RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

  # 3. Remove index.html from URLs
  RewriteCond %{THE_REQUEST} /index\.html [NC]
  RewriteRule ^ / [R=301,L]

  # 4. Handle client-side routing
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ /index.html [L]
</IfModule>

<IfModule mod_headers.c>
  # Security Headers
  Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:; frame-src 'self' https://www.youtube.com https://youtube.com https://checkout.paystack.com; child-src 'self' https://www.youtube.com https://youtube.com https://checkout.paystack.com; frame-ancestors 'none';"
  Header set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "DENY"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header set Permissions-Policy "geolocation=(), microphone=(), camera=(self), payment=()"
</IfModule>